<!DOCTYPE html>
<html>
<head>
  <title>All Campaigns</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

  <style>
    body{
      background: linear-gradient(to right, #43cea2, #185a9d);
      min-height:100vh;
      font-family: "Segoe UI", sans-serif;
    }

    .page-wrapper{
      padding:40px 0;
    }

    .page-title{
      color:white;
      text-align:center;
      margin-bottom:40px;
    }

    .card{
      border-radius:18px;
      box-shadow:0 8px 20px rgba(0,0,0,0.2);
      transition:0.3s;
    }

    .card:hover{
      transform: translateY(-8px);
    }

    .card img{
      height:180px;
      object-fit:cover;
      border-radius:18px 18px 0 0;
    }

    .badge{
      font-size:0.85rem;
    }

    .card-body{
      background:#fff;
      border-radius:0 0 18px 18px;
    }

    .btn-sm{
      border-radius:8px;
    }

    .top-btn{
      margin-bottom:20px;
    }
  </style>
</head>

<body>

<div class="container page-wrapper">

  <div class="top-btn">
    <a href="/" class="btn btn-success">‚¨Ö Back to Home</a>
  </div>

  <h1 class="page-title">All Donation Campaigns</h1>

  <div class="row">

    <% campaigns.forEach(campaign => { %>
      <div class="col-md-4 mb-4">
        <div class="card">

          <img src="<%= campaign.imageUrl || 'https://picsum.photos/400/200' %>" class="card-img-top">

          <div class="card-body">

            <h5 class="card-title"><%= campaign.title %></h5>

            <span class="badge badge-info"><%= campaign.category %></span>

            <!-- STATUS -->
            <p class="mt-2 mb-1">
              <strong>Status:</strong>
              <% if (campaign.status === "active") { %>
                <span class="badge badge-success">Active</span>
              <% } else if (campaign.status === "completed") { %>
                <span class="badge badge-primary">Completed</span>
              <% } else { %>
                <span class="badge badge-danger">Expired</span>
              <% } %>
            </p>

            <p class="card-text">
              <%= campaign.description.substring(0,120) %>...
            </p>

            <p class="mb-1">
              <strong>Target:</strong> ‚Çπ<%= campaign.targetAmount %>
            </p>
            <p class="mb-1">
              <strong>Raised:</strong> ‚Çπ<%= campaign.raisedAmount %>
            </p>

            <p class="mb-2">
              <strong>Deadline:</strong>
              <%= new Date(campaign.deadline).toDateString() %>
            </p>

            <p class="mb-2">
              <strong>Created By:</strong>
              <%= campaign.creator.name %>
            </p>

            <a href="/api/campaigns/<%= campaign._id %>" 
               class="btn btn-primary btn-block btn-sm">
              View Details
            </a>

            <a href="/api/donations/stats/<%= campaign._id %>" 
               class="btn btn-info btn-block btn-sm">
              Check Collection
            </a>

            <a href="/api/donations/<%= campaign._id %>" 
               class="btn btn-success btn-block btn-sm">
              Donate Now
            </a>

            <!-- NGO OWNER CONTROLS -->
            <% if (
              user &&
              user.role === "ngo" &&
              campaign.creator._id.toString() === user._id.toString() &&
              campaign.status === "active"
            ) { %>

              <a href="/api/campaigns/<%= campaign._id %>/edit"
                 class="btn btn-warning btn-block btn-sm mt-2">
                ‚úè Edit Campaign
              </a>

              <form action="/api/campaigns/<%= campaign._id %>?_method=DELETE"
                    method="POST">
                <button class="btn btn-danger btn-block btn-sm mt-1">
                  üóë Delete Campaign
                </button>
              </form>

            <% } %>

          </div>
        </div>
      </div>
    <% }) %>

  </div>

  <div class="top-btn mt-4">
    <a href="/" class="btn btn-success">‚¨Ö Back to Home</a>
  </div>

</div>

</body>
</html>
